(* Content-type: application/vnd.wolfram.mathematica *)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Queue-SDP", "Title"],

Cell[CellGroupData[{

Cell["Preamble", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],

Cell[BoxData[{
 RowBox[{
  InterpretationBox[
   TagBox[
    DynamicModuleBox[{Typeset`open = False},
     FrameBox[
      PaneSelectorBox[{False->GridBox[{
         {
          PaneBox[GridBox[{
             {
              StyleBox[
               StyleBox[
                AdjustmentBox["\<\"[\[FilledSmallSquare]]\"\>",
                 BoxBaselineShift->-0.25,
                 BoxMargins->{{0, 0}, {-1, -1}}], "ResourceFunctionIcon",

                FontColor->RGBColor[
                 0.8745098039215686, 0.2784313725490196, 0.03137254901960784]],
               ShowStringCharacters->False,
               FontFamily->"Source Sans Pro Black",
               FontSize->0.6538461538461539 Inherited,
               FontWeight->"Heavy",
               PrivateFontOptions->{"OperatorSubstitution"->False}],
              StyleBox[
               RowBox[{
                StyleBox["DarkMode", "ResourceFunctionLabel"], " "}],
               ShowAutoStyles->False,
               ShowStringCharacters->False,
               FontSize->Rational[12, 13] Inherited,
               FontColor->GrayLevel[0.1]]}
            },
            GridBoxSpacings->{"Columns" -> {{0.25}}}],
           Alignment->Left,
           BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
           BaselinePosition->Baseline,
           FrameMargins->{{3, 0}, {0, 0}}],
          ItemBox[
           PaneBox[
            TogglerBox[Dynamic[Typeset`open], {True->

             DynamicBox[FEPrivate`FrontEndResource[
              "FEBitmaps", "IconizeCloser"],
              ImageSizeCache->{8.25, {1., 7.25}}], False->

             DynamicBox[FEPrivate`FrontEndResource[
              "FEBitmaps", "IconizeOpener"],
              ImageSizeCache->{8.25, {1., 7.25}}]},
             Appearance->None,
             BaselinePosition->Baseline,
             ContentPadding->False,
             FrameMargins->0],
            Alignment->Left,
            BaselinePosition->Baseline,
            FrameMargins->{{1, 1}, {0, 0}}],
           Frame->{{
              RGBColor[
              0.8313725490196079, 0.8470588235294118, 0.8509803921568627,
               0.5], False}, {False, False}}]}
        },
        BaselinePosition->{1, 1},
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}], True->
       GridBox[{
         {GridBox[{
            {
             PaneBox[GridBox[{
                {
                 StyleBox[
                  StyleBox[
                   AdjustmentBox["\<\"[\[FilledSmallSquare]]\"\>",
                    BoxBaselineShift->-0.25,
                    BoxMargins->{{0, 0}, {-1, -1}}], "ResourceFunctionIcon",

                   FontColor->RGBColor[
                    0.8745098039215686, 0.2784313725490196,
                    0.03137254901960784]],
                  ShowStringCharacters->False,
                  FontFamily->"Source Sans Pro Black",
                  FontSize->0.6538461538461539 Inherited,
                  FontWeight->"Heavy",
                  PrivateFontOptions->{"OperatorSubstitution"->False}],
                 StyleBox[
                  RowBox[{
                   StyleBox["DarkMode", "ResourceFunctionLabel"], " "}],
                  ShowAutoStyles->False,
                  ShowStringCharacters->False,
                  FontSize->Rational[12, 13] Inherited,
                  FontColor->GrayLevel[0.1]]}
               },
               GridBoxSpacings->{"Columns" -> {{0.25}}}],
              Alignment->Left,
              BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
              BaselinePosition->Baseline,
              FrameMargins->{{3, 0}, {0, 0}}],
             ItemBox[
              PaneBox[
               TogglerBox[Dynamic[Typeset`open], {True->

                DynamicBox[FEPrivate`FrontEndResource[
                 "FEBitmaps", "IconizeCloser"],
                 ImageSizeCache->{9.9, {2., 7.9}}], False->

                DynamicBox[FEPrivate`FrontEndResource[
                 "FEBitmaps", "IconizeOpener"],
                 ImageSizeCache->{9.9, {2., 7.9}}]},
                Appearance->None,
                BaselinePosition->Baseline,
                ContentPadding->False,
                FrameMargins->0],
               Alignment->Left,
               BaselinePosition->Baseline,
               FrameMargins->{{1, 1}, {0, 0}}],
              Frame->{{
                 RGBColor[
                 0.8313725490196079, 0.8470588235294118, 0.8509803921568627,
                  0.5], False}, {False, False}}]}
           },
           BaselinePosition->{1, 1},
           GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},

           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
           GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}]},
         {
          StyleBox[
           PaneBox[GridBox[{
              {
               RowBox[{
                TagBox["\<\"Version (latest): \"\>",
                 "IconizedLabel"], " ",
                TagBox["\<\"2.0.0\"\>",
                 "IconizedItem"]}]},
              {
               TagBox[

                TemplateBox[{
                 "\"Documentation \[RightGuillemet]\"",
                  "https://resources.wolframcloud.com/FunctionRepository/\
resources/DarkMode"},
                 "HyperlinkURL"],
                "IconizedItem"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},

             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            Alignment->Left,
            BaselinePosition->Baseline,
            FrameMargins->{{5, 4}, {0, 4}}], "DialogStyle",
           FontFamily->"Roboto",
           FontSize->11]}
        },
        BaselinePosition->{1, 1},
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxDividers->{"Columns" -> {{None}}, "Rows" -> {False, {
             GrayLevel[0.8]}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, Dynamic[
       Typeset`open],
       BaselinePosition->Baseline,
       ImageSize->Automatic],
      Background->RGBColor[
       0.9686274509803922, 0.9764705882352941, 0.984313725490196],
      BaselinePosition->Baseline,
      DefaultBaseStyle->{},
      FrameMargins->{{0, 0}, {1, 0}},
      FrameStyle->RGBColor[
       0.8313725490196079, 0.8470588235294118, 0.8509803921568627],
      RoundingRadius->4]],
    {"FunctionResourceBox",
     RGBColor[0.8745098039215686, 0.2784313725490196, 0.03137254901960784],
     "DarkMode"},
    TagBoxNote->"FunctionResourceBox"],
   ResourceFunction[
    ResourceObject[
     Association[
     "Name" -> "DarkMode", "ShortName" -> "DarkMode", "UUID" ->
      "6ae9b15e-dd80-4d11-be6e-434bf9ac9265", "ResourceType" -> "Function",
      "Version" -> "2.0.0", "Description" ->
      "Restyle notebooks into dark mode", "RepositoryLocation" ->
      URL["https://www.wolframcloud.com/objects/resourcesystem/api/1.0"],
      "SymbolName" ->
      "FunctionRepository`$f2abd2063089401aafe135eb354a8d92`DarkMode",
      "FunctionLocation" ->
      CloudObject[
       "https://www.wolframcloud.com/obj/91755122-26ae-43f1-8e41-\
4043472dcf8a"]], ResourceSystemBase -> Automatic]],
   Selectable->False], ";"}], "\[IndentingNewLine]",
 RowBox[{"SetOptions", "[",
  RowBox[{
   RowBox[{"SelectedNotebook", "[", "]"}], ",",
   RowBox[{"PrintingStyleEnvironment", "\[Rule]", "\"\<Printout\>\""}], ",",
   RowBox[{"ShowSyntaxStyles", "\[Rule]", "True"}]}],
  "]"}], "\[IndentingNewLine]",
 RowBox[{"ClearAll", "[",
  RowBox[{"Evaluate", "[",
   RowBox[{
    RowBox[{"ToString", "[",
     RowBox[{"Context", "[", "]"}], "]"}], "<>", "\"\<*\>\""}], "]"}],
  "]"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}]],

Cell[CellGroupData[{

Cell["Definitions", "Section"],

Cell[CellGroupData[{

Cell["Basic Functions", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"integerCompositions", "=",
   RowBox[{
    RowBox[{"Reverse", "[",
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<IntegerCompositions\>\"", "]"}],
      "[",
      RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"edg2mat", "=",
   RowBox[{
    RowBox[{"(",
     RowBox[{
      RowBox[{"(",
       RowBox[{"\[FormalX]", "\[Function]",
        RowBox[{
         RowBox[{"(",
          RowBox[{"\[FormalY]", "\[Function]",
           RowBox[{"(",
            RowBox[{"\[FormalX]", "+", "\[FormalY]"}], ")"}]}], ")"}], "/@",
         "#"}]}], ")"}], "/@", "#"}], ")"}], "&"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[{
 "How ",
 Cell[BoxData[
  FormBox["integerCompositions", TraditionalForm]], "Input",
  FontSize->18,ExpressionUUID->"8e192a63-460a-4b0a-9ad8-7c54f703582f"],
 " w",
 StyleBox["or",
  FontColor->RGBColor[
   0.8235294117647058, 0.4906538490882734, 0.20227359426260777`]],
 "ks"
}], "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],

Cell[TextData[{
 "The following lines breakdown the internal steps of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"ResourceFunction", "[", "\"\<IntegerCompositions\>\"", "]"}],
   TraditionalForm]],ExpressionUUID->"0612544d-83e9-4d76-85db-772ad69754fb"],
 " and shows how the compositions are generated."
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],

Cell[BoxData[{
 RowBox[{"Clear", "[",
  RowBox[{"n", ",", "k"}], "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"n", "=", "2"}], ";",
  RowBox[{"k", "=", "3"}], ";"}], "\[IndentingNewLine]",
 RowBox[{"Range", "[",
  RowBox[{"n", "+", "k", "-", "1"}], "]"}], "\[IndentingNewLine]",
 RowBox[{"Subsets", "[",
  RowBox[{"%", ",",
   RowBox[{"{",
    RowBox[{"k", "-", "1"}], "}"}]}], "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Join", "[",
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "#", ",",
     RowBox[{"{",
      RowBox[{"n", "+", "k"}], "}"}]}], "]"}], "&"}], "/@",
  "%"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Partition", "[",
    RowBox[{"#", ",", "2", ",", "1"}], "]"}], "&"}], "/@",
  "%"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Reverse", "@",
   RowBox[{"Map", "[",
    RowBox[{
     RowBox[{
      RowBox[{"(",
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
        "-",
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        ")"}], "&"}], ",", "%", ",",
     RowBox[{"{", "2", "}"}]}], "]"}]}], "-", "1"}], "\[IndentingNewLine]",
 RowBox[{"Clear", "[",
  RowBox[{"n", ",", "k"}], "]"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}]],

Cell[CellGroupData[{

Cell["Miscalleneous", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
    RowBox[{"How", " ", "to", " ", "slice", " ", "a", " ", "4"}], "-",
    RowBox[{
    "dimensional", " ", "array", " ", "and", " ", "save", " ", "as", " ",
     RowBox[{"MATLAB", " ", ".", "mat"}], " ", "files"}]}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{"ls", "=",
     RowBox[{"ConstantArray", "[",
      RowBox[{"1", ",",
       RowBox[{"{",
        RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MapIndexed", "[",
       RowBox[{
        RowBox[{
         RowBox[{"{",
          RowBox[{"slc", ",", "idx"}], "}"}], "\[Function]",
         RowBox[{"List", "[",
          RowBox[{
           RowBox[{
            RowBox[{"StringTemplate", "[", "\"\<`1``2`.mat\>\"", "]"}], "[",
            RowBox[{
             RowBox[{"ToString", "[",
              RowBox[{"Unevaluated", "[", "#", "]"}], "]"}], ",",
             RowBox[{"idx", "[",
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "slc"}], "]"}]}],
        ",",
        RowBox[{"Evaluate", "[",
         RowBox[{"Transpose", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "@",
     RowBox[{"Unevaluated", "@", "ls"}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{"(*",
    RowBox[{
    "Unneeded", " ", "since", " ", "there", " ", "are", " ", "now", " ",
     "HDF5", " ", "files"}], "*)"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "Ap0", "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Ap0", "[",
   RowBox[{"p_", ",",
    RowBox[{"k_", ":", "1"}]}], "]"}], ":=",
  RowBox[{
   RowBox[{"Ap0", "[",
    RowBox[{"p", ",", "k"}], "]"}], "=",
   RowBox[{"SparseArray", "[",
    RowBox[{
     RowBox[{
      RowBox[{"loc", "[",
       RowBox[{"{",
        RowBox[{
         RowBox[{"p", " ",
          RowBox[{"UnitVector", "[",
           RowBox[{"K", ",", "k"}], "]"}]}], ",",
         RowBox[{"ConstantArray", "[",
          RowBox[{"0", ",", "K"}], "]"}]}], "}"}], "]"}], "\[Rule]", "1"}],
     ",", "matICdim"}], "]"}]}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Ap0", "::", "usage"}], "=",
   "\"\<Ap0[p,k] returns the coefficient matrix of the \
\!\(\*Cell[TextData[StyleBox[\"p\",FontSlant->\"Italic\"]],ExpressionUUID->\"\
68f4c655-4059-49e4-9908-e3afa40d9152\"]\)-th moment of the \
\!\(\*Cell[TextData[StyleBox[\"que\",FontSlant->\"Italic\"]],ExpressionUUID->\
\"86d09b70-5828-46a7-a5cc-bf7c03049d7e\"]\)-th queue as the SDP \
objective\>\""}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}]]
}]],

Cell[CellGroupData[{

Cell["SDP cone-matrix", "Subsection"],

Cell[CellGroupData[{

Cell[TextData[{
 "For the sake of clarity, the usually known ",
 ButtonBox["multi-index notation",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://en.wikipedia.org/wiki/Multi-index_notation"], None},
  ButtonNote->"https://en.wikipedia.org/wiki/Multi-index_notation"],
 " is hereafter called a vecponent (i.e., ",
 ButtonBox["vector exponent",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://mathworld.wolfram.com/ExponentVector.html"], None},
  ButtonNote->"https://mathworld.wolfram.com/ExponentVector.html"],
 ")."
}], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*",
   RowBox[{
   "Only", " ", "memoized", " ", "recursives", " ", "are", " ", "explicitly",
    " ", "cleared", " ", "before", " ", "definition"}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"K", "::", "usage"}], "=", "\"\<number of queues\>\""}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"r", "::", "usage"}], "=", "\"\<rank of relaxation\>\""}], ";"}],
    "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"K", "=", "3"}], ";",
    RowBox[{"r", "=", "3"}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]IC", "::", "usage"}], "=",
     "\"\<concerned \
\!\(\*Cell[TextData[StyleBox[\"\[Alpha]\",FontSize->12,FontWeight->\"Bold\"]],\
ExpressionUUID->\"8ab6b8df-cf8b-4ebf-b553-1292cd24f184\"]\) vecponents\>\""}],
     ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"\[Alpha]IC", "=",
     RowBox[{"Join", "@@",
      RowBox[{"Table", "[",
       RowBox[{
        RowBox[{"integerCompositions", "[",
         RowBox[{"\[FormalR]", ",", "K"}], "]"}], ",",
        RowBox[{"{",
         RowBox[{"\[FormalR]", ",", "0", ",",
          RowBox[{"2", "r"}]}], "}"}]}], "]"}]}]}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"edgIC", "::", "usage"}], "=",
     "\"\<concerned \!\(\*Cell[TextData[{
StyleBox[\"(\",FontSize->12],
StyleBox[\"\[Alpha]\",FontSize->12,FontWeight->\"Bold\"],
StyleBox[\",\[Beta])\",FontSize->12]
}],ExpressionUUID->\"c3b0083a-6358-403e-a84d-f2841e0f07bb\"]\) \
vecponents\>\""}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"edgIC", "=",
     RowBox[{"Join", "@@",
      RowBox[{"Table", "[",
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ArrayReshape", "[",
           RowBox[{"#", ",",
            RowBox[{"{",
             RowBox[{"2", ",", "K"}], "}"}]}], "]"}], "&"}], "/@",
         RowBox[{"integerCompositions", "[",
          RowBox[{"\[FormalR]", ",",
           RowBox[{"2", "K"}]}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"\[FormalR]", ",", "0", ",", "r"}], "}"}]}], "]"}]}]}],
    ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"matIC", "::", "usage"}], "=",
     "\"\<concerned semi-positive-definite matrix, represented as \
vecponents\>\""}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"matIC", "=",
     RowBox[{"edgIC", "//", "edg2mat"}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"matICdim", "=",
     RowBox[{"Dimensions", "[",
      RowBox[{"matIC", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]",
   RowBox[{
    RowBox[{"ClearAll", "[", "loc", "]"}], ";",
    RowBox[{
     RowBox[{"loc", "::", "usage"}], "=",
     "\"\<look up a vecponent in matIC\>\""}], ";",
    RowBox[{
     RowBox[{"loc", "::", "usage", "::", "ChineseSimplified"}], "=",
     "\"\<\:5728 \
\!\(\*Cell[\"matIC\",ExpressionUUID->\"f9c59498-c2df-441e-bfcd-d428861ac95b\"]\
\) \:4e2d\:67e5\:627e\:4e00\:4e2a\:591a\:91cd\:6307\:6807\>\""}], ";"}],
   "\[IndentingNewLine]",
   RowBox[{
    RowBox[{
     RowBox[{"loc", "[", "vecponent_", "]"}], ":=",
     RowBox[{
      RowBox[{"loc", "[", "vecponent", "]"}], "=",
      RowBox[{"FirstPosition", "[",
       RowBox[{"matIC", ",", "vecponent", ",",
        RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}], ",",
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True]
}]],

Cell[CellGroupData[{

Cell["Misc", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matX", "::", "usage"}], "=",
   "\"\<formal representation of \
\!\(\*Cell[\"matIC\",ExpressionUUID->\"e638f67f-5d65-4182-8cf8-09e82d577ffe\"]\
\)\>\""}], ";",
  RowBox[{
   RowBox[{"matX", "::", "usage", "::", "ChineseSimplified"}], "=",
   "\"\<\!\(\*Cell[\"matIC\",ExpressionUUID->\"4695cc3c-2d18-4885-a35f-\
1bcaf9f9d706\"]\) \:7684\:5f62\:5f0f\:8868\:793a\>\""}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"matX", "[", "]"}], "=",
   RowBox[{"Map", "[",
    RowBox[{
     RowBox[{
      RowBox[{"Superscript", "[",
       RowBox[{
        RowBox[{"Style", "[",
         RowBox[{"\[FormalX]", ",", "Larger"}], "]"}], ",",
        RowBox[{"Style", "[",
         RowBox[{
          RowBox[{"MatrixForm", "[",
           RowBox[{"#", ",",
            RowBox[{"TableSpacing", "\[Rule]",
             RowBox[{"{",
              RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", "Smaller"}],
         "]"}]}], "]"}], "&"}], ",", "matIC", ",",
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"matX", "[",
    RowBox[{"s_", ":",
     RowBox[{"Except", "[", "All", "]"}]}], "]"}], ":=",
   RowBox[{
    RowBox[{"matX", "[", "s", "]"}], "=",
    RowBox[{"Map", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Subsuperscript", "[",
        RowBox[{
         RowBox[{"Style", "[",
          RowBox[{"\[FormalX]", ",", "Larger"}], "]"}], ",", "s", ",",
         RowBox[{"Style", "[",
          RowBox[{
           RowBox[{"MatrixForm", "[",
            RowBox[{"#", ",",
             RowBox[{"TableSpacing", "\[Rule]",
              RowBox[{"{",
               RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", "Smaller"}],
          "]"}]}], "]"}], "&"}], ",", "matIC", ",",
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"matX", "[", "All", "]"}], "=",
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"matX", "[", "k", "]"}], ",",
     RowBox[{"{",
      RowBox[{"k", ",", "1", ",",
       SuperscriptBox["2", "K"]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True]
}]]
}]],

Cell[CellGroupData[{

Cell["Known moments", "Subsection"],

Cell[TextData[{
 "In the semi-definite optimisation procedure, ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{"m", "(",
      StyleBox["\[Beta]",
       FontWeight->"Bold"], ")"}], " ", "=", " ",
     RowBox[{
      RowBox[{"\[DoubleStruckCapitalE]", "[", Cell[TextData[Cell[BoxData[
        FormBox[
         SuperscriptBox[
          StyleBox["X",
           FontWeight->"Bold"],
          StyleBox["\[Beta]",
           FontWeight->"Bold"]], TraditionalForm]],ExpressionUUID->
        "9193c70f-ee14-462e-95f4-12faba39350e"]],ExpressionUUID->
        "d60c0cf6-3d5a-4373-9ee4-0da051d4cdbe"], "]"}], "=",
      RowBox[{"\[DoubleStruckCapitalE]", "[", Cell[TextData[Cell[BoxData[
        FormBox[
         SuperscriptBox[
          RowBox[{"(",
           RowBox[{
            StyleBox["S",
             FontWeight->"Bold"], "-",
            StyleBox["A",
             FontWeight->"Bold"]}], ")"}],
          StyleBox["\[Beta]",
           FontWeight->"Bold"]], TraditionalForm]],ExpressionUUID->
        "d53a3a45-d868-437f-8521-617f6cd6c588"]],ExpressionUUID->
        "cf1a464e-dc64-4e30-8cb3-936aed773204"], "]"}]}]}],
    FontSize->12], TraditionalForm]], "InlineFormula",ExpressionUUID->
  "9d4f3c05-aab0-4be2-8664-b78c887e00c4"],
 ", the moments of the increments to the per-queue waiting times must be \
known. The current version of our code uses the moments of the service time \
and arrival time respectively to calculate these quantities."
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "::", "usage"}], "=", "\"\<arrival rate\>\""}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]", "::", "usage"}], "=", "\"\<service rate\>\""}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"\[Lambda]", "=", ".5"}], ";",
  RowBox[{"\[Mu]", "=", "1"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Arrival", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[",
   RowBox[{
   "M", ",", "inprobs", ",", "D0", ",", "D1", ",", "ArrivalPi", ",",
    "ArrivalMoment", ",", "ArrivalMoment"}], "]"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
   "The", " ", "whole", " ", "MAP", " ", "feature", " ", "is", " ",
    "currently", " ", "suspended"}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"M", "::", "usage"}], "=",
   "\"\<rank of the supposed markovian arrival process (MAP)\>\""}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"M", "=", "2"}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"inprobs", "::", "usage"}], "=",
   "\"\<probabilities a ingoing package belonging to the corresponding \
queue\>\""}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"inprobs", "=",
   FractionBox[
    RowBox[{"Table", "[",
     RowBox[{"1", ",", "K"}], "]"}], "K"]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"D0", "::", "usage"}], "=",
   "\"\<transition rate matrix of the MAP\>\""}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"D1", "::", "usage"}], "=",
   "\"\<emission rate matrix of the MAP\>\""}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"D0", "=",
   RowBox[{"(", GridBox[{
      {
       RowBox[{"-", "2"}], "0"},
      {"0",
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}
     }], ")"}]}], ";",
  RowBox[{"D1", "=",
   RowBox[{"(", GridBox[{
      {
       RowBox[{"3", "/", "5"}],
       RowBox[{"7", "/", "5"}]},
      {
       RowBox[{"7", "/", "20"}],
       RowBox[{"3", "/", "20"}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ArrivalPi", "=",
    RowBox[{"Normalize", "[",
     RowBox[{
      RowBox[{"First", "@",
       RowBox[{"NullSpace", "[",
        RowBox[{"D0", "+", "D1"}], "]"}]}], ",", "Total"}], "]"}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrivalMoment", "::", "usage"}], "=",
    "\"\<Moments of the overall arrival; you can call it as \
\!\(\*Cell[TextData[Cell[BoxData[FormBox[RowBox[{\"ArrivalMoment\", \"[\", \
StyleBox[Cell[\"integer\",ExpressionUUID->\"524f825d-3170-455f-acad-\
77fd43ed275b\"],FontSlant->\"Italic\"], \"]\"}], \
TraditionalForm]],ExpressionUUID->\"8990b7d6-703a-438b-812a-5aff2e15e916\"]],\
ExpressionUUID->\"03a8b042-e4ec-4772-866c-cb8b8283d9fa\"]\)\>\""}], ";"}],
  RowBox[{"(*", " ",
   RowBox[{"or", " ", Cell[TextData[Cell[BoxData[
     FormBox[
      SuperscriptBox[
       RowBox[{"ArrivalMoment", "[", "]"}],
       StyleBox[Cell[
        "integer",ExpressionUUID->"15dd358f-ad74-41fb-a0a5-1680737c3f84"],
        FontSlant->"Italic"]], TraditionalForm]],ExpressionUUID->
     "cddb2e89-fa1d-4677-956f-b4639ca16c9f"]],ExpressionUUID->
     "eb7fb9fd-2a83-4ebe-9647-50c1a0f44f1c"], "\"\<;\>"}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"ArrivalMoment", "/:",
     RowBox[{"Power", "[",
      RowBox[{"ArrivalMoment", ",", "k_Integer"}], "]"}], ":=",
     RowBox[{"ArrivalMoment", "[", "k", "]"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"ArrivalMoment", "/:",
     RowBox[{"Power", "[",
      RowBox[{
       RowBox[{"ArrivalMoment", "[", "]"}], ",", "k_Integer"}], "]"}], ":=",
     RowBox[{"ArrivalMoment", "[", "k", "]"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{
     RowBox[{"ArrivalMoment", "[", "k_Integer", "]"}], ":=",
     RowBox[{
      RowBox[{"ArrivalMoment", "[", "k", "]"}], "=",
      RowBox[{
       RowBox[{"(",
        RowBox[{"M", "!"}], ")"}], "*",
       RowBox[{"ArrivalPi", ".",
        RowBox[{"MatrixPower", "[",
         RowBox[{
          RowBox[{"-", "D0"}], ",",
          RowBox[{"-", "k"}], ",",
          RowBox[{"Table", "[",
           RowBox[{"1", ",", "M"}], "]"}]}], "]"}]}]}]}]}], ";"}],
   RowBox[{"(*", "suspended", "*)"}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrivalMoment", "[", "k_Integer", "]"}], ":=",
    RowBox[{
     RowBox[{"ArrivalMoment", "[", "k", "]"}], "=",
     RowBox[{"Moment", "[",
      RowBox[{
       RowBox[{"PoissonDistribution", "[",
        RowBox[{"1", "/", "\[Lambda]"}], "]"}], ",", "k"}], "]"}]}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ArrivalMoment", "::", "usage"}], "=",
    "\"\<Moments of per-queue arrivals\>\""}], ";"}],
  RowBox[{"(*", "unused", "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ArrivalMoments", "[", "\[Beta]_List", "]"}], ":=",
   RowBox[{
    RowBox[{"ArrivalMoment", "[", "\[Beta]", "]"}], "=",
    RowBox[{"MapThread", "[",
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["#2", "#1"],
        RowBox[{"ArrivalMoment", "[", "#1", "]"}]}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"\[Beta]", ",", "inprobs"}], "}"}]}], "]"}]}]}],
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.814354147217802*^9, 3.8143541925808816`*^9}, {
   3.8143542364420433`*^9, 3.814354268589903*^9}, {3.814354302000815*^9,
   3.814354484514713*^9}, {3.8143545416935205`*^9, 3.814354541813964*^9}, {
   3.814354711811903*^9, 3.8143547217012334`*^9}, 3.81435517231498*^9,
   3.8143553341665645`*^9, {3.8143554226568813`*^9, 3.814355626943615*^9}, {
   3.8143557308065777`*^9, 3.814355781870577*^9}, {3.8143560649920087`*^9,
   3.8143560854756804`*^9}, {3.814399643721156*^9, 3.8143996671351104`*^9},
   3.814408503824012*^9, 3.814408697862784*^9, {3.8184821544156275`*^9,
   3.8184821788606253`*^9}, 3.8184851541654778`*^9, {3.821571675963249*^9,
   3.82157169475276*^9}, {3.821572098593541*^9, 3.8215721046059585`*^9}, {
   3.8216055623780327`*^9, 3.8216056086333075`*^9}, {3.8216748352155304`*^9,
   3.8216748415791063`*^9}, {3.821674878656392*^9, 3.821674901547779*^9}, {
   3.8216764157642665`*^9, 3.8216764733022003`*^9}, {3.8216765072526317`*^9,
   3.8216765779145975`*^9}, {3.821676629903329*^9, 3.821676672625868*^9}, {
   3.821679166032086*^9, 3.8216793556741595`*^9}, {3.8216794023356795`*^9,
   3.8216794576824226`*^9}, 3.8216797839553375`*^9, {3.8216798788120594`*^9,
   3.8216799679949865`*^9}, 3.8216800088471823`*^9, 3.821699807985315*^9, {
   3.82169984389784*^9, 3.821699853641487*^9}, {3.8217014677978044`*^9,
   3.821701530190349*^9}, {3.821701593626543*^9, 3.8217015943369093`*^9}, {
   3.822478048621821*^9, 3.8224780497127504`*^9}, {3.8228116647089396`*^9,
   3.8228116827422295`*^9}, 3.8228117191344805`*^9, 3.822811759039522*^9, {
   3.8228736017750387`*^9, 3.822873602011322*^9}, {3.82287380109065*^9,
   3.8228738292712927`*^9}, {3.822873920945613*^9, 3.8228739249783573`*^9}, {
   3.8228740228210173`*^9, 3.8228740337520847`*^9}, {3.822874066878928*^9,
   3.822874067043927*^9}, 3.8228741487611322`*^9, {3.822888732149809*^9,
   3.8228887415826797`*^9}, {3.8228889103299212`*^9, 3.822889093385957*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"60055039-185b-4603-8de7-d9c6e20e2f5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Service", "Subsubsection",
 CellChangeTimes->{{3.814352040520709*^9, 3.8143520681261554`*^9}, {
  3.8216766401278114`*^9, 3.8216766414390364`*^9}, {3.8216793430802083`*^9,
  3.821679344423665*^9}},ExpressionUUID->"0de55b95-a8fa-421f-b258-\
5c3b36e7ef2d"],

Cell[BoxData[{
 RowBox[{"Clear", "[",
  RowBox[{"outprobs", ",", "ServiceMoment", ",", "ServiceMoments"}],
  "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"outprobs", "::", "usage"}], "=",
   "\"\<probabilities the server serving the first package at the head of the \
corresponding queue\>\""}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"outprobs", "=",
    FractionBox[
     RowBox[{"Table", "[",
      RowBox[{"1", ",", "K"}], "]"}], "K"]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ServiceMoment", "::", "usage"}], "=",
    "\"\<Moments of the overall service; you can call it as \
\!\(\*Cell[TextData[Cell[BoxData[FormBox[RowBox[{\"ServiceMoment\", \"[\", \
StyleBox[Cell[\"integer\",ExpressionUUID->\"ae20adc6-ca96-49b4-a29b-\
8afc63e8c8a8\"],FontSlant->\"Italic\"], \"]\"}], \
TraditionalForm]],ExpressionUUID->\"ce2f02f1-9895-44f0-9382-eaa9f30562e7\"]],\
ExpressionUUID->\"39c0edb1-9e34-4b42-9414-620c753d6590\"]\)\>\""}], ";"}],
  RowBox[{"(*", " ",
   RowBox[{"or", " ", Cell[TextData[Cell[BoxData[
     FormBox[
      SuperscriptBox[
       RowBox[{"ServiceMoment", "[", "]"}],
       StyleBox[Cell[
        "integer",ExpressionUUID->"7ddb47e0-c3a5-4902-95c2-4aa977d10e0f"],
        FontSlant->"Italic"]], TraditionalForm]],ExpressionUUID->
     "24ce4245-3667-420c-a00a-3fd574c237fe"]],ExpressionUUID->
     "4d9ed55c-c07a-4665-809f-a6f3ef733a24"], "\"\<;\>"}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"ServiceMoment", "/:",
     RowBox[{"Power", "[",
      RowBox[{"ServiceMoment", ",", "k_Integer"}], "]"}], ":=",
     RowBox[{"ServiceMoment", "[", "k", "]"}]}], ";"}], "*)"}],
  "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{"ServiceMoment", "/:",
     RowBox[{"Power", "[",
      RowBox[{
       RowBox[{"ServiceMoment", "[", "]"}], ",", "k_Integer"}], "]"}], ":=",
     RowBox[{"ServiceMoment", "[", "k", "]"}]}], ";"}],
   "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ServiceMoment", "[", "k_Integer", "]"}], ":=",
    RowBox[{
     RowBox[{"ServiceMoment", "[", "k", "]"}], "=",
     RowBox[{"Moment", "[",
      RowBox[{
       RowBox[{"PoissonDistribution", "[",
        RowBox[{"1", "/", "\[Mu]"}], "]"}], ",", "k"}], "]"}]}]}], ";"}],
  "\[IndentingNewLine]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ServiceMoments", "::", "usage"}], "=",
    "\"\<Moments of per-queue services\>\""}], ";"}],
  RowBox[{"(*", "unused", "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ServiceMoments", "[", "\[Beta]_List", "]"}], ":=",
   RowBox[{
    RowBox[{"ServiceMoments", "[", "\[Beta]", "]"}], "=",
    RowBox[{"MapThread", "[",
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["#2", "#1"],
        RowBox[{"ServiceMoment", "[", "#1", "]"}]}], "&"}], ",",
      RowBox[{"{",
       RowBox[{"\[Beta]", ",", "outprobs"}], "}"}]}], "]"}]}]}],
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}]],

Cell[CellGroupData[{

Cell["Increment", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "m", "]"}], "\[IndentingNewLine]",
  RowBox[{"(*",
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", "\[Beta]_List", "]"}], ":=",
     RowBox[{
      RowBox[{"m", "[", "\[Beta]", "]"}], "=",
      RowBox[{"Times", "@@",
       RowBox[{"MapThread", "[",
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["#2", "#1"],
           RowBox[{"ArrivalMoment", "[", "#1", "]"}]}], "&"}], ",",
         RowBox[{"{",
          RowBox[{"\[Beta]", ",", "inprob"}], "}"}]}], "]"}]}]}]}], ";"}],
   RowBox[{"(*", "WRONG", "*)"}], "*)"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", "\[Beta]_List", "]"}], ":=",
   RowBox[{
    RowBox[{"m", "[", "\[Beta]", "]"}], "=",
    RowBox[{
     UnderoverscriptBox["\[Product]",
      RowBox[{"\[FormalK]", "=", "1"}], "K"],
     RowBox[{"(",
      RowBox[{
       UnderoverscriptBox["\[Sum]",
        RowBox[{"\[FormalL]", "=", "1"}], "K"],
       RowBox[{"(",
        RowBox[{
         RowBox[{"Binomial", "[",
          RowBox[{
           RowBox[{
           "\[Beta]", "\[LeftDoubleBracket]", "\[FormalK]",
            "\[RightDoubleBracket]"}], ",", "\[FormalL]"}], "]"}],
         SuperscriptBox[
          RowBox[{"(",
           RowBox[{"-", "1"}], ")"}], "\[FormalL]"],
         SuperscriptBox[
          RowBox[{
          "outprobs", "\[LeftDoubleBracket]", "\[FormalK]",
           "\[RightDoubleBracket]"}],
          RowBox[{
           RowBox[{
           "\[Beta]", "\[LeftDoubleBracket]", "\[FormalK]",
            "\[RightDoubleBracket]"}], "-", "\[FormalL]"}]],
         RowBox[{"ServiceMoment", "[",
          RowBox[{
           RowBox[{
           "\[Beta]", "\[LeftDoubleBracket]", "\[FormalK]",
            "\[RightDoubleBracket]"}], "-", "\[FormalL]"}], "]"}],
         SuperscriptBox[
          RowBox[{
          "inprobs", "\[LeftDoubleBracket]", "\[FormalK]",
           "\[RightDoubleBracket]"}], "\[FormalL]"],
         RowBox[{"ArrivalMoment", "[", "\[FormalL]", "]"}]}], ")"}]}],
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"(*",
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", "\[Beta]_List", "]"}], ":=",
     RowBox[{
      RowBox[{"m", "[", "\[Beta]", "]"}], "=",
      RowBox[{
       UnderoverscriptBox["\[Product]",
        RowBox[{"\[FormalK]", "=", "1"}], "K"],
       RowBox[{"(",
        RowBox[{
         UnderoverscriptBox["\[Sum]",
          RowBox[{"\[FormalL]", "=", "1"}], "K"],
         RowBox[{"(",
          RowBox[{
           RowBox[{"Binomial", "[",
            RowBox[{
             RowBox[{
             "\[Beta]", "\[LeftDoubleBracket]", "\[FormalK]",
              "\[RightDoubleBracket]"}], ",", "\[FormalL]"}], "]"}],
           SuperscriptBox[
            RowBox[{"(",
             RowBox[{
              RowBox[{
              "outprobs", "\[LeftDoubleBracket]", "\[FormalK]",
               "\[RightDoubleBracket]"}], " ",
              RowBox[{"ServiceMoment", "[", "]"}]}], ")"}],
            RowBox[{
             RowBox[{
             "\[Beta]", "\[LeftDoubleBracket]", "\[FormalK]",
              "\[RightDoubleBracket]"}], "-", "\[FormalL]"}]],
           SuperscriptBox[
            RowBox[{"(",
             RowBox[{
              RowBox[{"-",
               RowBox[{
               "inprobs", "\[LeftDoubleBracket]", "\[FormalK]",
                "\[RightDoubleBracket]"}]}], " ",
              RowBox[{"ArrivalMoment", "[", "]"}]}], ")"}], "\[FormalL]"]}],
          ")"}]}], ")"}]}]}]}], ";"}], "*)"}],
  RowBox[{
   RowBox[{
    RowBox[{"m", "::", "usage"}], "=",
    "\"\<Moments of \
\!\(\*Cell[TextData[StyleBox[\"X\",FontSlant->\"Italic\"]],ExpressionUUID->\"\
6956a59a-9e16-4220-a37f-8b369610efa0\"]\); the generally true form from the \
arrival and service moments.\>\""}], ";",
   RowBox[{
    RowBox[{"m", "::", "usage", "::", "ChineseSimplified"}], "=",
    "\"\<\!\(\*Cell[TextData[StyleBox[\"X\",FontSlant->\"Italic\"]],\
ExpressionUUID->\"3826e130-d0a4-4639-b889-fffb8e7570c6\"]\) \
\:7684\:5404\:9636\:77e9; \:4ece\:5230\:8fbe\:8fc7\:7a0b\:548c\:670d\:52a1\
\:8fc7\:7a0b\:7684\:5404\:9636\:77e9\:5f97\:5230\:7684\:666e\:904d\:6210\:7acb\
\:7684\:5f62\:5f0f.\>\""}], ";"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{"Clear", "[", "m", "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", "\[Beta]_List", "]"}], ":=",
   RowBox[{
    RowBox[{"m", "[", "\[Beta]", "]"}], "=",
    RowBox[{"Times", "@@",
     RowBox[{"MapThread", "[",
      RowBox[{
       RowBox[{
        RowBox[{"Expectation", "[",
         RowBox[{
          SuperscriptBox[
           RowBox[{"(",
            RowBox[{
             RowBox[{"#3", "\[FormalS]"}], "-",
             RowBox[{"#2", "\[FormalA]"}]}], ")"}], "#1"], ",",
          RowBox[{"{",
           RowBox[{
            RowBox[{"\[FormalS]", "\[Distributed]",
             RowBox[{"NormalDistribution", "[",
              RowBox[{
               RowBox[{"1", "/", "4"}], ",",
               SqrtBox[
                RowBox[{"1", "/", "8"}]]}], "]"}]}], ",",
            RowBox[{"\[FormalA]", "\[Distributed]",
             RowBox[{"NormalDistribution", "[",
              RowBox[{
               RowBox[{"1", "/", "2"}], ",",
               SqrtBox[
                RowBox[{"1", "/", "8"}]]}], "]"}]}]}], "}"}]}], "]"}], "&"}],
       ",",
       RowBox[{"{",
        RowBox[{"\[Beta]", ",", "inprobs", ",", "outprobs"}], "}"}]}],
      "]"}]}]}]}], ";",
  RowBox[{
   RowBox[{"m", "::", "usage"}], "=",
   "\"\<Moments of \
\!\(\*Cell[TextData[StyleBox[\"X\",FontSlant->\"Italic\"]],ExpressionUUID->\"\
8be5f428-cee1-4abe-9522-fda28d2572d8\"]\); the one used in \!\(\*TemplateBox[{
RowBox[{\"Bertsimas\", \" \", \"and\", \" \", \"Natarajan\", \" \", \
\"2007\"}], {
URL[\"https://doi.org/10.1007/s11134-007-9028-7\"], None}, \
\"https://doi.org/10.1007/s11134-007-9028-7\", \"HyperlinkActionNew\", \
{\"HyperlinkActive\"}, BaseStyle -> {\"Hyperlink\"}, HyperlinkAction -> \"New\
\"},\"HyperlinkTemplate\"]\).\>\""}], ";",
  RowBox[{
   RowBox[{"m", "::", "usage", "::", "ChineseSimplified"}], "=",
   "\"\<\!\(\*Cell[TextData[StyleBox[\"X\",FontSlant->\"Italic\"]],\
ExpressionUUID->\"60e06b5b-d98e-4dd8-a16b-9b8496da7c49\"]\) \
\:7684\:5404\:9636\:77e9; \!\(\*TemplateBox[{
RowBox[{\"Bertsimas\", \" \", \"\:548c\", \" \", \"Natarajan\", \" \", \"2007\
\"}], {
URL[\"https://doi.org/10.1007/s11134-007-9028-7\"], None}, \
\"https://doi.org/10.1007/s11134-007-9028-7\", \"HyperlinkActionNew\", \
{\"HyperlinkActive\"}, BaseStyle -> {\"Hyperlink\"}, HyperlinkAction -> \"New\
\"},\"HyperlinkTemplate\"]\) \:4e2d\:4f7f\:7528\:7684\:5f62\:5f0f.\>\""}],
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{"Clear", "[", "m", "]"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"m", "[",
    RowBox[{"{",
     RowBox[{"0", ".."}], "}"}], "]"}], ":=", "1"}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"m", "[",
    RowBox[{"{", "\[Beta]_Integer", "}"}], "]"}], ":=",
   RowBox[{
    RowBox[{"m", "[", "\[Beta]", "]"}], "=",
    SuperscriptBox["\[FormalM]",
     RowBox[{"Style", "[",
      RowBox[{"\[Beta]", ",", "Smaller"}], "]"}]]}]}],
  ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"If", "[",
   RowBox[{
    RowBox[{"K", ">", "1"}], ",",
    RowBox[{
     RowBox[{"m", "[", "\[Beta]_List", "]"}], ":=",
     RowBox[{
      RowBox[{"m", "[", "\[Beta]", "]"}], "=",
      SuperscriptBox["\[FormalM]",
       RowBox[{"Style", "[",
        RowBox[{
         RowBox[{"TableForm", "[",
          RowBox[{"\[Beta]", ",",
           RowBox[{"TableSpacing", "\[Rule]",
            RowBox[{"{",
             RowBox[{"0", ",", "0"}], "}"}]}], ",",
           RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], ",",
         "Smaller"}], "]"}]]}]}]}], "]"}], ";",
  RowBox[{
   RowBox[{"m", "::", "usage"}], "=",
   "\"\<Moments of \
\!\(\*Cell[TextData[StyleBox[\"X\",FontSlant->\"Italic\"]],ExpressionUUID->\"\
ceabc312-249c-4a64-9716-39cfc44427ee\"]\); remained abstract.\>\""}], ";",
  RowBox[{
   RowBox[{"m", "::", "usage", "::", "ChineseSimplified"}], "=",
   "\"\<\!\(\*Cell[TextData[StyleBox[\"X\",FontSlant->\"Italic\"]],\
ExpressionUUID->\"9e9e31a3-41cf-42ee-a3a2-2955105981bc\"]\) \
\:7684\:5404\:9636\:77e9; \:4fdd\:7559\:62bd\:8c61\:5f62\:5f0f.\>\""}],
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}]],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "/:",
   RowBox[{"Power", "[",
    RowBox[{"m", ",", "\[Beta]_List"}], "]"}], ":=",
   RowBox[{"m", "[", "\[Beta]", "]"}]}], ";"}]], "Input",
 InitializationCell->True]
}]]
}]],

Cell[CellGroupData[{

Cell["Constraints LHS", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ConstraintMatView", "[",
    RowBox[{"array_List", "|", "array_SparseArray"}], "]"}], ":=",
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"If", "[",
       RowBox[{
        RowBox[{
         RowBox[{"ArrayDepth", "@", "#"}], ">", "1"}], ",",
        RowBox[{
         RowBox[{"Map", "[",
          RowBox[{"Column", ",", "#", ",",
           RowBox[{"{",
            RowBox[{
             RowBox[{"ArrayDepth", "@", "#"}], "-", "1"}], "}"}]}], "]"}],
         "&"}], ",", "Identity"}], "]"}], "@",
      RowBox[{"Map", "[",
       RowBox[{"Row", ",", "#", ",",
        RowBox[{"{",
         RowBox[{
          RowBox[{"ArrayDepth", "@", "#"}], "-", "1"}], "}"}]}], "]"}]}],
     "&"}], "@",
    RowBox[{"(",
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[",
        RowBox[{"MatrixForm", ",", "#", ",",
         RowBox[{"{",
          RowBox[{
           RowBox[{"ArrayDepth", "@", "#"}], "-", "2"}], "}"}]}], "]"}],
       "&"}], "@",
      RowBox[{"Normal", "[", "array", "]"}]}], ")"}]}]}], ";",
  RowBox[{
   RowBox[{"ConstraintMatView", "::", "usage"}], "=",
   "\"\<Show constraints as matrices; 3-d tensors are shown as a row of \
matrices.\>\""}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"ConstraintEqnView", "[",
    RowBox[{"array_List", "|", "array_SparseArray"}], "]"}], ":=",
   RowBox[{
    RowBox[{"If", "[",
     RowBox[{
      RowBox[{
       RowBox[{"ArrayDepth", "@", "array"}], ">", "3"}], ",",
      RowBox[{
       RowBox[{"Column", "[",
        RowBox[{"Map", "[",
         RowBox[{
          RowBox[{
           RowBox[{"(",
            RowBox[{
             RowBox[{"Total", "[",
              RowBox[{
               RowBox[{"Times", "[",
                RowBox[{"#", ",",
                 RowBox[{"matX", "[", "All", "]"}]}], "]"}], ",",
               RowBox[{"{",
                RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "\[Equal]", "0"}],
            ")"}], "&"}], ",", "#", ",",
          RowBox[{"{",
           RowBox[{
            RowBox[{"ArrayDepth", "@", "array"}], "-", "3"}], "}"}]}], "]"}],
        "]"}], "&"}], ",",
      RowBox[{
       RowBox[{"(",
        RowBox[{
         RowBox[{"Total", "[",
          RowBox[{
           RowBox[{"Times", "[",
            RowBox[{"#", ",",
             RowBox[{"matX", "[", "All", "]"}]}], "]"}], ",",
           RowBox[{"{",
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "\[Equal]",
         RowBox[{"If", "[",
          RowBox[{
           RowBox[{
            RowBox[{"ArrayDepth", "@", "array"}], ">", "3"}], ",", "0", ",",
           "1"}], "]"}]}], ")"}], "&"}]}], "]"}], "@",
    RowBox[{"Normal", "[", "array", "]"}]}]}], ";",
  RowBox[{
   RowBox[{"ConstraintEqnView", "::", "usage"}], "=",
   "\"\<Show constraints as equations.\>\""}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],

Cell[CellGroupData[{

Cell["The constraint of independence; a list of 3-d arrays.", "ItemNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]",
     RowBox[{
      StyleBox["s",
       FontSlant->"Italic"], "=", "1"}],
     SuperscriptBox["2",
      StyleBox["K",
       FontSlant->"Italic"]]],
    SubsuperscriptBox[
     StyleBox["x",
      FontSlant->"Italic"],
     StyleBox["s",
      FontSlant->"Italic"],
     StyleBox[
      RowBox[{"\[Alpha]", "\[InvisibleComma]", "\[Beta]"}],
      FontWeight->"Bold"]]}], "-",
   RowBox[{
    SuperscriptBox[
     StyleBox["m",
      FontSlant->"Italic"],
     StyleBox["\[Beta]",
      FontWeight->"Bold"]],
    RowBox[{
     UnderoverscriptBox["\[Sum]",
      RowBox[{
       StyleBox["s",
        FontSlant->"Italic"], "=", "1"}],
      SuperscriptBox["2",
       StyleBox["K",
        FontSlant->"Italic"]]],
     SubsuperscriptBox[
      StyleBox["x",
       FontSlant->"Italic"],
      StyleBox["s",
       FontSlant->"Italic"],
      StyleBox[
       RowBox[{"\[Alpha]", "\[InvisibleComma]", "0"}],
       FontWeight->"Bold"]]}]}]}], "\[Equal]",
  "0"}]], "DisplayFormulaNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 TextAlignment->-0.5],

Cell[BoxData[
 RowBox[{
  RowBox[{"IndieA", "=",
   RowBox[{
    RowBox[{
     RowBox[{"(",
      RowBox[{
       RowBox[{"SparseArray", "/@",
        RowBox[{"Map", "[",
         RowBox[{
          RowBox[{"(",
           RowBox[{"\[FormalY]", "\[Function]",
            RowBox[{
             RowBox[{"SparseArray", "[",
              RowBox[{
               RowBox[{"{",
                RowBox[{
                 RowBox[{"Prepend", "[",
                  RowBox[{
                   RowBox[{"loc", "[", "\[FormalY]", "]"}], ",", "_"}], "]"}],
                  "\[RuleDelayed]", "1"}], "}"}], ",",
               RowBox[{"Prepend", "[",
                RowBox[{"matICdim", ",",
                 SuperscriptBox["2", "K"]}], "]"}]}], "]"}], "-",
             RowBox[{"SparseArray", "[",
              RowBox[{
               RowBox[{"{",
                RowBox[{
                 RowBox[{"Prepend", "[",
                  RowBox[{
                   RowBox[{"loc", "[",
                    RowBox[{"\[FormalY]", "*",
                    RowBox[{"{",
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "_"}],
                  "]"}], "\[RuleDelayed]",
                 RowBox[{"m", "[",
                  RowBox[{"\[FormalY]", "\[LeftDoubleBracket]",
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}]}],
                "}"}], ",",
               RowBox[{"Prepend", "[",
                RowBox[{"matICdim", ",",
                 SuperscriptBox["2", "K"]}], "]"}]}], "]"}]}]}], ")"}], ",",
          RowBox[{"DeleteDuplicates", "[",
           RowBox[{"Flatten", "[",
            RowBox[{"#", ",", "1"}], "]"}], "]"}]}], "]"}]}], "/.",
       RowBox[{"(",
        RowBox[{
         RowBox[{"SparseArray", "[",
          RowBox[{
           RowBox[{"{",
            RowBox[{"_", "\[RuleDelayed]", "0"}], "}"}], ",",
           RowBox[{"Prepend", "[",
            RowBox[{"matICdim", ",",
             SuperscriptBox["2", "K"]}], "]"}]}], "]"}], "\[Rule]",
         "Nothing"}], ")"}]}], ")"}], "&"}], "@", "matIC"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True]
}]],

Cell[CellGroupData[{

Cell["The constraint of combinatorics; a list of 3-d arrays.", "ItemNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]",
     RowBox[{
      StyleBox["s",
       FontSlant->"Italic"], "=", "1"}],
     SuperscriptBox["2",
      StyleBox["K",
       FontSlant->"Italic"]]],
    SubsuperscriptBox[
     StyleBox["x",
      FontSlant->"Italic"],
     StyleBox["s",
      FontSlant->"Italic"],
     StyleBox[
      RowBox[{"\[Alpha]", "\[InvisibleComma]", "0"}],
      FontWeight->"Bold"]]}], "-",
   RowBox[{
    UnderoverscriptBox["\[Sum]",
     RowBox[{
      StyleBox["s",
       FontSlant->"Italic"], "=", "1"}],
     SuperscriptBox["2",
      StyleBox["K",
       FontSlant->"Italic"]]],
    RowBox[{
     UnderscriptBox["\[Sum]",
      RowBox[{
       RowBox[{"\[LeftBracketingBar]",
        StyleBox["\[Gamma]",
         FontWeight->"Bold"], "\[RightBracketingBar]"}], "\[LessEqual]",
       RowBox[{"\[LeftBracketingBar]",
        StyleBox["\[Alpha]",
         FontWeight->"Bold"], "\[RightBracketingBar]"}]}]],
     RowBox[{
      SubsuperscriptBox[
       StyleBox["g",
        FontSlant->"Italic"],
       RowBox[{
        StyleBox["k",
         FontSlant->"Italic"], "\[InvisibleComma]",
        StyleBox["\[Alpha]",
         FontWeight->"Bold"]}],
       StyleBox["\[Gamma]",
        FontWeight->"Bold"]],
      SubsuperscriptBox["x", "s",
       StyleBox["\[Gamma]",
        FontWeight->"Bold"]]}]}]}]}], "\[Equal]",
  "0"}]], "DisplayFormulaNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 TextAlignment->-0.5],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CombieA", "=",
    RowBox[{
     RowBox[{
      RowBox[{"-",
       RowBox[{"(",
        RowBox[{
         RowBox[{"SparseArray", "@",
          RowBox[{"SparseArray", "[",
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[",
              RowBox[{
               RowBox[{"Table", "[",
                RowBox[{
                 RowBox[{
                  RowBox[{"CoefficientRules", "[",
                   RowBox[{
                    RowBox[{"Times", "@@",
                    RowBox[{"(",
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(",
                    RowBox[{"Table", "[",
                    RowBox[{
                    RowBox[{
                    RowBox[{"Indexed", "[",
                    RowBox[{"\[FormalW]", ",", "\[FormalK]"}], "]"}], "+",
                    RowBox[{"Indexed", "[",
                    RowBox[{"\[FormalX]", ",", "\[FormalK]"}], "]"}]}], ",",
                    RowBox[{"{",
                    RowBox[{"\[FormalK]", ",", "1", ",", "K"}], "}"}]}],
                    "]"}], ")"}], "#"], "/.",
                    RowBox[{"Thread", "[",
                    RowBox[{
                    RowBox[{"Table", "[",
                    RowBox[{
                    RowBox[{
                    RowBox[{"Indexed", "[",
                    RowBox[{"\[FormalW]", ",", "\[FormalK]"}], "]"}], "+",
                    RowBox[{"Indexed", "[",
                    RowBox[{"\[FormalX]", ",", "\[FormalK]"}], "]"}]}], ",",
                    RowBox[{"{",
                    RowBox[{"\[FormalK]", ",",
                    RowBox[{"Position", "[",
                    RowBox[{
                    RowBox[{"IntegerDigits", "[",
                    RowBox[{"\[FormalS]", ",", "2", ",", "K"}], "]"}], ",",
                    "0"}], "]"}]}], "}"}]}], "]"}], "\[Rule]", "0"}], "]"}]}],
                     ")"}]}], ",",
                    RowBox[{
                    RowBox[{"Table", "[",
                    RowBox[{
                    RowBox[{"Indexed", "[",
                    RowBox[{"\[FormalW]", ",", "\[FormalK]"}], "]"}], ",",
                    RowBox[{"{",
                    RowBox[{"\[FormalK]", ",", "1", ",", "K"}], "}"}]}],
                    "]"}], "~", "Join", "~",
                    RowBox[{"Table", "[",
                    RowBox[{
                    RowBox[{"Indexed", "[",
                    RowBox[{"\[FormalX]", ",", "\[FormalK]"}], "]"}], ",",
                    RowBox[{"{",
                    RowBox[{"\[FormalK]", ",", "1", ",", "K"}], "}"}]}],
                    "]"}]}]}], "]"}], "/.",
                  RowBox[{"(",
                   RowBox[{
                    RowBox[{"(",
                    RowBox[{"list_", "\[Rule]", "coef_"}], ")"}],
                    "\[RuleDelayed]",
                    RowBox[{"(",
                    RowBox[{
                    RowBox[{"Prepend", "[",
                    RowBox[{
                    RowBox[{"loc", "[",
                    RowBox[{"ArrayReshape", "[",
                    RowBox[{"list", ",",
                    RowBox[{"{",
                    RowBox[{"2", ",", "K"}], "}"}]}], "]"}], "]"}], ",",
                    RowBox[{"\[FormalS]", "+", "1"}]}], "]"}], "\[Rule]",
                    RowBox[{"If", "[",
                    RowBox[{
                    RowBox[{
                    RowBox[{"list", "\[LeftDoubleBracket]",
                    RowBox[{";;", "K"}], "\[RightDoubleBracket]"}],
                    "\[Equal]", "#"}], ",",
                    RowBox[{"coef", "-", "1"}], ",", "coef"}], "]"}]}],
                    ")"}]}], ")"}]}], ",",
                 RowBox[{"{",
                  RowBox[{"\[FormalS]", ",", "0", ",",
                   RowBox[{
                    SuperscriptBox["2", "K"], "-", "1"}]}], "}"}]}], "]"}],
               ",", "1"}], "]"}], "~", "Join", "~",
             RowBox[{"{",
              RowBox[{
               RowBox[{"Prepend", "[",
                RowBox[{
                 RowBox[{"loc", "[",
                  RowBox[{"{",
                   RowBox[{"#", ",",
                    RowBox[{"Table", "[",
                    RowBox[{"0", ",", "K"}], "]"}]}], "}"}], "]"}], ",",
                 "_"}], "]"}], "\[Rule]",
               RowBox[{"-", "1"}]}], "}"}]}], ",",
            RowBox[{"Prepend", "[",
             RowBox[{"matICdim", ",",
              SuperscriptBox["2", "K"]}], "]"}]}], "]"}]}], "/.",
         RowBox[{"(",
          RowBox[{
           RowBox[{"SparseArray", "[",
            RowBox[{
             RowBox[{"{",
              RowBox[{"_", "\[RuleDelayed]", "0"}], "}"}], ",",
             RowBox[{"Prepend", "[",
              RowBox[{"matICdim", ",",
               SuperscriptBox["2", "K"]}], "]"}]}], "]"}], "\[Rule]",
           "Nothing"}], ")"}]}], ")"}]}], "&"}], "/@",
     RowBox[{"Rest", "[", "\[Alpha]IC", "]"}]}]}], ";"}], " "}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True]
}]],

Cell[CellGroupData[{

Cell["The constraint of unitisation; a list of 3-d arrays.", "ItemNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   UnderoverscriptBox["\[Sum]",
    RowBox[{
     StyleBox["s",
      FontSlant->"Italic"], "=", "1"}],
    SuperscriptBox["2",
     StyleBox["K",
      FontSlant->"Italic"]]],
   SubsuperscriptBox[
    StyleBox["x",
     FontSlant->"Italic"],
    StyleBox["s",
     FontSlant->"Italic"],
    StyleBox[
     RowBox[{"0", "\[InvisibleComma]", "0"}],
     FontWeight->"Bold"]]}], "\[Equal]", "1"}]], "DisplayFormulaNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 TextAlignment->-0.5],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnieA", "=",
   RowBox[{"SparseArray", "@",
    RowBox[{"SparseArray", "[",
     RowBox[{
      RowBox[{
       RowBox[{"Prepend", "[",
        RowBox[{
         RowBox[{"loc", "[",
          RowBox[{"ConstantArray", "[",
           RowBox[{"0", ",",
            RowBox[{"{",
             RowBox[{"2", ",", "K"}], "}"}]}], "]"}], "]"}], ",", "_"}],
        "]"}], "\[Rule]", "1"}], ",",
      RowBox[{"Prepend", "[",
       RowBox[{"matICdim", ",",
        SuperscriptBox["2", "K"]}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True],

Cell[TextData[{
 "Additional constraint due to coincident entries; ",
 StyleBox["only one",
  FontWeight->"Bold"],
 " 3-d array."
}], "ItemNumbered",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoinA", "=",
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"If", "[",
       RowBox[{
        RowBox[{"#", "\[NotEqual]",
         RowBox[{"{", "}"}]}], ",", "SparseArray", ",", "Identity"}], "]"}],
      "@",
      RowBox[{"Flatten", "[",
       RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@",
    RowBox[{"(",
     RowBox[{
      RowBox[{"(",
       RowBox[{"mat", "\[Function]", " ",
        RowBox[{"If", "[",
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "mat", "]"}], ">", "2"}], ",",
          RowBox[{
           RowBox[{
            RowBox[{"SparseArray", "[",
             RowBox[{"#", ",", "matICdim"}], "]"}], "&"}], "/@",
           RowBox[{"(",
            RowBox[{
             RowBox[{
              RowBox[{"{",
               RowBox[{
                RowBox[{
                 RowBox[{
                 "mat", "\[LeftDoubleBracket]", "1",
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",",
                RowBox[{"#", "\[Rule]",
                 RowBox[{"-", "1"}]}]}], "}"}], "&"}], "/@",
             RowBox[{"mat", "\[LeftDoubleBracket]",
              RowBox[{"2", ";;",
               RowBox[{"Ceiling", "[",
                RowBox[{
                 RowBox[{"Length", "[", "mat", "]"}], "/", "2"}], "]"}]}],
              "\[RightDoubleBracket]"}]}], ")"}]}], ",", "Nothing"}], "]"}]}],
        ")"}], "/@",
      RowBox[{"(",
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[",
          RowBox[{"matIC", ",", "#", ",", "2"}], "]"}], "&"}], "/@",
        RowBox[{"DeleteDuplicates", "[",
         RowBox[{"Flatten", "[",
          RowBox[{"matIC", ",", "1"}], "]"}], "]"}]}], ")"}]}], ")"}]}]}],
  ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True]
}]],

Cell[CellGroupData[{

Cell["Verification", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{"edgIC", "\[IndentingNewLine]", "\[Alpha]IC"}], "Input"]
}]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=",
   RowBox[{"{", "2", "}"}]}], ";"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"Indexed", "[",
     RowBox[{"\[FormalW]", ",", "k"}], "]"}], ",",
    RowBox[{"{",
     RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], "~", "Join", "~",
  RowBox[{"Table", "[",
   RowBox[{
    RowBox[{"Indexed", "[",
     RowBox[{"\[FormalX]", ",", "k"}], "]"}], ",",
    RowBox[{"{",
     RowBox[{"k", ",", "1", ",", "K"}], "}"}]}],
   "]"}]}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Times", "@@",
    SuperscriptBox[
     RowBox[{"(",
      RowBox[{"Table", "[",
       RowBox[{
        RowBox[{
         RowBox[{"Indexed", "[",
          RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
         RowBox[{"Indexed", "[",
          RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
        RowBox[{"{",
         RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], ")"}], "#"]}],
   "&"}], "@", "temp"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"Thread", "[",
      RowBox[{
       RowBox[{"Table", "[",
        RowBox[{
         RowBox[{
          RowBox[{"Indexed", "[",
           RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
          RowBox[{"Indexed", "[",
           RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
         RowBox[{"{",
          RowBox[{"k", ",",
           RowBox[{"Position", "[",
            RowBox[{
             RowBox[{"IntegerDigits", "[",
              RowBox[{"s", ",", "2", ",", "K"}], "]"}], ",", "0"}], "]"}]}],
          "}"}]}], "]"}], "\[Rule]", "0"}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"s", ",", "0", ",",
       RowBox[{
        SuperscriptBox["2", "K"], "-", "1"}]}], "}"}]}], "]"}], "&"}], "@",
  "temp"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"Times", "@@",
      RowBox[{"(",
       RowBox[{
        SuperscriptBox[
         RowBox[{"(",
          RowBox[{"Table", "[",
           RowBox[{
            RowBox[{
             RowBox[{"Indexed", "[",
              RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
             RowBox[{"Indexed", "[",
              RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
            RowBox[{"{",
             RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], ")"}], "#"], "/.",
        RowBox[{"Thread", "[",
         RowBox[{
          RowBox[{"Table", "[",
           RowBox[{
            RowBox[{
             RowBox[{"Indexed", "[",
              RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
             RowBox[{"Indexed", "[",
              RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
            RowBox[{"{",
             RowBox[{"k", ",",
              RowBox[{"Position", "[",
               RowBox[{
                RowBox[{"IntegerDigits", "[",
                 RowBox[{"s", ",", "2", ",", "K"}], "]"}], ",", "0"}],
               "]"}]}], "}"}]}], "]"}], "\[Rule]", "0"}], "]"}]}], ")"}]}],
     ",",
     RowBox[{"{",
      RowBox[{"s", ",", "0", ",",
       RowBox[{
        SuperscriptBox["2", "K"], "-", "1"}]}], "}"}]}], "]"}], "&"}], "@",
  "temp"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[",
    RowBox[{
     RowBox[{"CoefficientRules", "[",
      RowBox[{
       RowBox[{"Times", "@@",
        RowBox[{"(",
         RowBox[{
          SuperscriptBox[
           RowBox[{"(",
            RowBox[{"Table", "[",
             RowBox[{
              RowBox[{
               RowBox[{"Indexed", "[",
                RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
               RowBox[{"Indexed", "[",
                RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
              RowBox[{"{",
               RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], ")"}], "#"],
           "/.",
          RowBox[{"Thread", "[",
           RowBox[{
            RowBox[{"Table", "[",
             RowBox[{
              RowBox[{
               RowBox[{"Indexed", "[",
                RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
               RowBox[{"Indexed", "[",
                RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
              RowBox[{"{",
               RowBox[{"k", ",",
                RowBox[{"Position", "[",
                 RowBox[{
                  RowBox[{"IntegerDigits", "[",
                   RowBox[{"s", ",", "2", ",", "K"}], "]"}], ",", "0"}],
                 "]"}]}], "}"}]}], "]"}], "\[Rule]", "0"}], "]"}]}], ")"}]}],
       ",",
       RowBox[{
        RowBox[{"Table", "[",
         RowBox[{
          RowBox[{"Indexed", "[",
           RowBox[{"\[FormalW]", ",", "k"}], "]"}], ",",
          RowBox[{"{",
           RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], "~", "Join",
        "~",
        RowBox[{"Table", "[",
         RowBox[{
          RowBox[{"Indexed", "[",
           RowBox[{"\[FormalX]", ",", "k"}], "]"}], ",",
          RowBox[{"{",
           RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}]}]}], "]"}], ",",
     RowBox[{"{",
      RowBox[{"s", ",", "0", ",",
       RowBox[{
        SuperscriptBox["2", "K"], "-", "1"}]}], "}"}]}], "]"}], "&"}], "@",
  "temp"}], "\[IndentingNewLine]",
 RowBox[{
  RowBox[{
   RowBox[{"(",
    RowBox[{
     RowBox[{"Table", "[",
      RowBox[{
       RowBox[{
        RowBox[{"CoefficientRules", "[",
         RowBox[{
          RowBox[{"Times", "@@",
           RowBox[{"(",
            RowBox[{
             SuperscriptBox[
              RowBox[{"(",
               RowBox[{"Table", "[",
                RowBox[{
                 RowBox[{
                  RowBox[{"Indexed", "[",
                   RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
                  RowBox[{"Indexed", "[",
                   RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
                 RowBox[{"{",
                  RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], ")"}],
              "#"], "/.",
             RowBox[{"Thread", "[",
              RowBox[{
               RowBox[{"Table", "[",
                RowBox[{
                 RowBox[{
                  RowBox[{"Indexed", "[",
                   RowBox[{"\[FormalW]", ",", "k"}], "]"}], "+",
                  RowBox[{"Indexed", "[",
                   RowBox[{"\[FormalX]", ",", "k"}], "]"}]}], ",",
                 RowBox[{"{",
                  RowBox[{"k", ",",
                   RowBox[{"Position", "[",
                    RowBox[{
                    RowBox[{"IntegerDigits", "[",
                    RowBox[{"s", ",", "2", ",", "K"}], "]"}], ",", "0"}],
                    "]"}]}], "}"}]}], "]"}], "\[Rule]", "0"}], "]"}]}],
            ")"}]}], ",",
          RowBox[{
           RowBox[{"Table", "[",
            RowBox[{
             RowBox[{"Indexed", "[",
              RowBox[{"\[FormalW]", ",", "k"}], "]"}], ",",
             RowBox[{"{",
              RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}], "~", "Join",
           "~",
           RowBox[{"Table", "[",
            RowBox[{
             RowBox[{"Indexed", "[",
              RowBox[{"\[FormalX]", ",", "k"}], "]"}], ",",
             RowBox[{"{",
              RowBox[{"k", ",", "1", ",", "K"}], "}"}]}], "]"}]}]}], "]"}], "/.",
        RowBox[{"(",
         RowBox[{
          RowBox[{"(",
           RowBox[{"list_", "\[Rule]", "coef_"}], ")"}], "\[RuleDelayed]",
          RowBox[{"(",
           RowBox[{
            RowBox[{"Prepend", "[",
             RowBox[{
              RowBox[{"loc", "[",
               RowBox[{"ArrayReshape", "[",
                RowBox[{"list", ",",
                 RowBox[{"{",
                  RowBox[{"2", ",", "K"}], "}"}]}], "]"}], "]"}], ",",
              RowBox[{"s", "+", "1"}]}], "]"}], "\[RuleDelayed]",
            RowBox[{"If", "[",
             RowBox[{
              RowBox[{
               RowBox[{"list", "\[LeftDoubleBracket]",
                RowBox[{";;", "K"}], "\[RightDoubleBracket]"}], "\[Equal]",
               "#"}], ",",
              RowBox[{"coef", "-", "1"}], ",", "coef"}], "]"}]}], ")"}]}],
         ")"}]}], ",",
       RowBox[{"{",
        RowBox[{"s", ",", "0", ",",
         RowBox[{
          SuperscriptBox["2", "K"], "-", "1"}]}], "}"}]}], "]"}], "~", "Join",
      "~",
     RowBox[{"{",
      RowBox[{
       RowBox[{"Prepend", "[",
        RowBox[{
         RowBox[{"loc", "[",
          RowBox[{"{",
           RowBox[{"#", ",",
            RowBox[{"Table", "[",
             RowBox[{"0", ",", "K"}], "]"}]}], "}"}], "]"}], ",", "_"}],
        "]"}], "\[Rule]",
       RowBox[{"-", "1"}]}], "}"}]}], ")"}], "&"}], "@",
  "temp"}], "\[IndentingNewLine]",
 RowBox[{"Clear", "[", "temp", "]"}], "\[IndentingNewLine]"}], "Input"]
}]]
}]]
}]]
}]],

Cell[CellGroupData[{

Cell["Results", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[",
     RowBox[{"#", ",", " ",
      RowBox[{"PageWidth", " ", "->", " ", "Infinity"}]}], "]"}], "&"}], "/@",
   RowBox[{"{",
    RowBox[{
     RowBox[{"CellObject", "[", "22833", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "90689", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "90705", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "91313", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "91121", "]"}]}], "\n", "}"}]}],
  ";"}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matX", "[", "]"}], "//", "MatrixForm"}], "\[IndentingNewLine]",
 RowBox[{"CombieA", "//", "ConstraintEqnView"}], "\[IndentingNewLine]",
 RowBox[{"IndieA", "//", "ConstraintEqnView"}], "\[IndentingNewLine]",
 RowBox[{"UnieA", "//", "ConstraintEqnView"}]}], "Input",
 PageWidth:>DirectedInfinity[1],
 ShowCellBracket->Automatic,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[",
     RowBox[{"#", ",", " ",
      RowBox[{"PageWidth", " ", "->", " ", "Infinity"}]}], "]"}], "&"}], "/@",
   RowBox[{"{",
    RowBox[{
     RowBox[{"CellObject", "[", "93505", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "94673", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "94145", "]"}], ",", " ",
     RowBox[{"CellObject", "[", "94545", "]"}]}], "\n", "}"}]}],
  ";"}]], "Code",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],

Cell[BoxData[{
 RowBox[{"CombieA", "//", "ConstraintMatView"}], "\[IndentingNewLine]",
 RowBox[{"IndieA", "//", "ConstraintMatView"}], "\[IndentingNewLine]",
 RowBox[{"UnieA", "//", "ConstraintMatView"}]}], "Input",
 PageWidth:>DirectedInfinity[1],
 ShowCellBracket->Automatic,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->False]
}]]
}]]
}]]
}]
(* End of Notebook Content *)
